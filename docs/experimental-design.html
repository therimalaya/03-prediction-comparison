<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Experimental Design | Comparison of Multivariate Prediction Methods</title>
  <meta name="description" content="Experimental Design | Comparison of Multivariate Prediction Methods">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="Experimental Design | Comparison of Multivariate Prediction Methods" />
  <meta property="og:type" content="book" />
  <meta property="og:url" content="http://therimalaya.github.io/03-prediction-comparison" />
  
  
  <meta name="github-repo" content="therimalaya/03-prediction-comparison" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Experimental Design | Comparison of Multivariate Prediction Methods" />
  
  
  



<meta name="date" content="2019-01-08">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="prediction-methods.html">
<link rel="next" href="exploration.html">
<style type="text/css">
p.abstract{
  text-align: center;
  font-weight: bold;
}
div.abstract{
  margin: auto;
  width: 90%;
}
</style>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./index.html"><strong>Multivariate Comparison</strong></a></li>
<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Introduction</a></li>
<li class="chapter" data-level="" data-path="simulation-model.html"><a href="simulation-model.html"><i class="fa fa-check"></i>Simulation Model</a></li>
<li class="chapter" data-level="" data-path="prediction-methods.html"><a href="prediction-methods.html"><i class="fa fa-check"></i>Prediction Methods</a><ul>
<li class="chapter" data-level="" data-path="prediction-methods.html"><a href="prediction-methods.html#modification-in-envelope-estimation"><i class="fa fa-check"></i>Modification in envelope estimation</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="experimental-design.html"><a href="experimental-design.html"><i class="fa fa-check"></i>Experimental Design</a><ul>
<li class="chapter" data-level="" data-path="experimental-design.html"><a href="experimental-design.html#basis-of-comparison"><i class="fa fa-check"></i>Basis of comparison</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="exploration.html"><a href="exploration.html"><i class="fa fa-check"></i>Exploration</a></li>
<li class="chapter" data-level="" data-path="statistical-analysis.html"><a href="statistical-analysis.html"><i class="fa fa-check"></i>Statistical Analysis</a><ul>
<li><a href="statistical-analysis.html#effect-analysis-of-error-model">Effect Analysis of <em>Error Model</em></a></li>
<li><a href="statistical-analysis.html#effect-analysis-of-component-model">Effect Analysis of <em>Component Model</em></a></li>
</ul></li>
<li class="chapter" data-level="" data-path="discussions-and-conclusion.html"><a href="discussions-and-conclusion.html"><i class="fa fa-check"></i>Discussions and Conclusion</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="appendix"><span><b>Appendix A</b></span></li>
<li class="chapter" data-level="" data-path="shiny-application.html"><a href="shiny-application.html"><i class="fa fa-check"></i>Shiny Application</a></li>
<li class="chapter" data-level="" data-path="reproduce.html"><a href="reproduce.html"><i class="fa fa-check"></i>Reproduce</a></li>
<li class="divider"></li>
<li class="toc-footer"><a href="https://bookdown.org" target="blank">Published with <em>BookDown</em></a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Comparison of Multivariate Prediction Methods</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="experimental-design" class="section level1">
<h1>Experimental Design</h1>
<p>This study compares prediction methods based on their prediction ability. Data with specific properties are simulated, some of which are easier to predict than others. These data are simulated using the R-package <code>simrel</code>, which is discussed in <span class="citation">Sæbø, Almøy, and Helland (<a href="references.html#ref-saebo2015simrel">2015</a>)</span> and <span class="citation">Rimal, Almøy, and Sæbø (<a href="references.html#ref-Rimal2018">2018</a>)</span>. Here we will use four different factors to vary the property of the data: a) Number of predictors (<code>p</code>), b) Multicollinearity in predictor variables (<code>gamma</code>), c) Correlation in response variables (<code>eta</code>) and d) position of predictor components relevant for the response (<code>relpos</code>). Using two levels of <code>p</code>, <code>gamma</code> and <code>relpos</code> and four levels of <code>eta</code>, 32 set of distinct properties are designed for the simulation.</p>
<dl>
<dt><strong>Number of predictors:</strong></dt>
<dd>In order to observe the performance of the methods on tall and wide predictor matrices, 20 and 250 predictor variables are simulated. Parameter <code>p</code> controls this properties in the <code>simrel</code> function.
</dd>
<dt><strong>Multicollinearity in predictor variables:</strong></dt>
<dd><p>Highly collinear predictors can be explained completely by few components. The parameter <code>gamma</code> (<span class="math inline">\(\gamma\)</span>) in <code>simrel</code> controls decline in the eigenvalues of the predictor variables as <a href="experimental-design.html#eq:gamma">(5)</a>.</p>
<span class="math display" id="eq:gamma">\[\begin{equation}
  \lambda_i = e^{-\gamma(i - 1)}, \gamma &gt; 0 \text{ and } i = 1, 2, \ldots, p
  \tag{5}
\end{equation}\]</span>
</dd>
</dl>
<p>Here, <span class="math inline">\(\lambda_i, i = 1, 2, \ldots p\)</span> are eigenvalues of the predictor variables. Here we have used 0.2 and 0.9 as different levels of <code>gamma</code>. The higher the value of gamma, the higher will be the multicollinearity and vice versa.</p>
<dl>
<dt><strong>Correlation in response variables:</strong></dt>
<dd><p>Correlation among response  variables is a less explored area. Here we have tried to explore that part with 4 levels of correlation in the response variables. We have used the <code>eta</code> (<span class="math inline">\(\eta\)</span>) parameter of <code>simrel</code> for controlling the decline in eigenvalues corresponding to the response variables as <a href="experimental-design.html#eq:eta">(6)</a>.</p>
<span class="math display" id="eq:eta">\[\begin{equation}
  \kappa_i = e^{-\eta(i - 1)}, \eta &gt; 0 \text{ and } j = 1, 2, \ldots, m
  \tag{6}
\end{equation}\]</span>
</dd>
</dl>
<p>Here, <span class="math inline">\(\kappa_i, i = 1, 2, \ldots m\)</span> are the eigenvalues of the response variables and <code>m</code> is the number of response variables. Here we have used 0, 0.4, 0.8 and 1.2 as different levels of <code>eta</code>. The larger the value of eta, the larger will be the correlation between response variables and vice versa.</p>
<dl>
<dt><strong>Position of predictor components relevant to the response:</strong></dt>
<dd>The principal components of the predictors are ordered. The first principal component captures most of the variation in the predictors. The second captures the most in the rest that is left by the first principal components and so on. In highly collinear predictors, the variation captured by the first few components is relatively high. However, if those components are not relevant for the response, prediction becomes difficult <span class="citation">(Helland and Almøy <a href="references.html#ref-Helland1994b">1994</a>)</span>. Here, two levels of the positions of these relevant components are used: 1, 2, 3, 4 and 5, 6, 7, 8.
</dd>
</dl>
<p>Further, a complete factorial design from the levels of the above given parameters gave us 32 designs. Each design is associated with a dataset having unique properties. Figure~<a href="experimental-design.html#fig:design-plot">2</a>, shows all the designs. For each design and prediction method, 50 datasets were simulated as replicates. In total, there were <span class="math inline">\(5 \times 32 \times 50\)</span>, i.e. 8000 dataset simulated.</p>
<div class="figure"><span id="fig:design-plot"></span>
<img src="main_files/figure-html/design-plot-1.svg" alt="Experimental Design of simulation parameters. Each point represents an unique data property." width="100%" />
<p class="caption">
Figure 2: Experimental Design of simulation parameters. Each point represents an unique data property.
</p>
</div>
<dl>
<dt><strong>Common parameters:</strong></dt>
<dd>Each dataset was simulated with <span class="math inline">\(n = 100\)</span> number of observation and <span class="math inline">\(m = 4\)</span> response variables. Further, the coefficient of determination corresponding to each response components in all the designs is set to and 0.8. In addition, we have assumed that there is only one informative response component. Hence, the informative response component is rotated orthogonally together with three uninformative response components to generate four response variables. This spread out the information in all simulated response variables. For further details on the simulation tool see <span class="citation">(Rimal, Almøy, and Sæbø <a href="references.html#ref-Rimal2018">2018</a>)</span>.
</dd>
</dl>
<p>An example of simulation parameters for the first design is as follows:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">simrel</span>(
    <span class="dt">n       =</span> <span class="dv">100</span>,                 ## Training samples
    <span class="dt">p       =</span> <span class="dv">20</span>,                  ## Predictors
    <span class="dt">m       =</span> <span class="dv">4</span>,                   ## Responses
    <span class="dt">q       =</span> <span class="dv">20</span>,                  ## Relevant predictors
    <span class="dt">relpos  =</span> <span class="kw">list</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)), ## Relevant predictor components index
    <span class="dt">eta     =</span> <span class="dv">0</span>,                   ## Decay factor of response eigenvalues
    <span class="dt">gamma   =</span> <span class="fl">0.2</span>,                 ## Decay factor of predictor eigenvalues
    <span class="dt">R2      =</span> <span class="fl">0.8</span>,                 ## Coefficient of determination
    <span class="dt">ypos    =</span> <span class="kw">list</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">4</span>)),
    <span class="dt">type    =</span> <span class="st">&quot;multivariate&quot;</span>
)</code></pre></div>
<div class="figure"><span id="fig:cov-plot-1"></span>
<img src="main_files/figure-html/cov-plot-1-1.svg" alt="(left) Covariance structure of latent components. (right) Covariance structure of predictor and response" width="100%" />
<p class="caption">
Figure 3: (left) Covariance structure of latent components. (right) Covariance structure of predictor and response
</p>
</div>
<p>Figure <a href="experimental-design.html#fig:cov-plot-1">3</a> shows the covariance structure of the data simulated with this design. The figure shows that the predictor components at position 1, 2, 3 and 4 are relevant for the first response component. After the rotation with orthogonal rotation matrix, all predictors are somewhat relevant for all response variables, fulfilling other desired properties like multicollinearity and coefficient of determination. For same design, Figure <a href="experimental-design.html#fig:est-cov-plot">4</a>(top left) shows that the predictor components 1, 2, 3 and 4 are relevant for the first response component. All other predictor components are irrelevant and all other response components are uninformative. However, due to orthogonal rotation of the informative response component together with uninformative response components, all response variables in the population have similar covariance with the relevant predictor components (Figure <a href="experimental-design.html#fig:est-cov-plot">4</a>(top right)). The sample covariances between the predictors components and predictor variables with response variables are in Figure <a href="experimental-design.html#fig:est-cov-plot">4</a> (bottom left) and (bottom right) respectively.</p>

<div class="figure"><span id="fig:est-cov-plot"></span>
<img src="main_files/figure-html/est-cov-plot-1.svg" alt="Expected Scaled absolute covariance between predictor components and response components (top left). Expected Scaled absolute covariance between predictor components and response variables (top right). Sample scaled absolute covariance between predictor components and response variables (bottom left). Sample scaled absolute covariance between predictor variables and response variables (bottom right). The bar in the background are eigenvalues corresponding to each components in population (top plots) and in sample (bottom plots). One can compare the top-right plot (true covariance of the population) with bottom-left (covariance in the simulated data) which shows a similar pattern for different components." width="100%" />
<p class="caption">
Figure 4: Expected Scaled absolute covariance between predictor components and response components (top left). Expected Scaled absolute covariance between predictor components and response variables (top right). Sample scaled absolute covariance between predictor components and response variables (bottom left). Sample scaled absolute covariance between predictor variables and response variables (bottom right). The bar in the background are eigenvalues corresponding to each components in population (top plots) and in sample (bottom plots). One can compare the top-right plot (true covariance of the population) with bottom-left (covariance in the simulated data) which shows a similar pattern for different components.
</p>
</div>
<p>A similar discussion can be made on all 32 designs where each of the design holds the properties of the data they simulate. These data are used by the prediction methods discussed in previous section. Each prediction methods are given independent dataset simulated in order to give them equal opportunity to understand the dynamics in the data.</p>
<div id="basis-of-comparison" class="section level2">
<h2>Basis of comparison</h2>
<p>This study focuses mainly on the prediction performance of the methods and emphasis specifically on the interaction between the properties of the data, controlled by the simulation parameters, and the prediction methods. The prediction performance is measured by the average of prediction error that a method can give using arbitrary number of components and number of components used to give the minimum prediction error. Let us define,</p>
<span class="math display" id="eq:pred-error">\[\begin{equation}
\mathcal{PE}_j = \frac{1}{\sigma_{y_j|x}^2}\left[\left(\boldsymbol{\beta}_j - \boldsymbol{\hat{\beta}_j}\right)^t\boldsymbol{\Sigma}_{xx}\left(\boldsymbol{\beta}_j - \boldsymbol{\hat{\beta}_j}\right)\right] + 1
\tag{7}
\end{equation}\]</span>
<p>as a prediction error for a given design, method, replication and number of components, where, <span class="math inline">\(\boldsymbol{\Sigma}_{xx}\)</span> is the true covariance matrix of predictor and <span class="math inline">\(\sigma_{y_j\mid x}\)</span> is the true model error obtained from simulation of response <span class="math inline">\(j = 1, \ldots m\)</span>. Here prediction error is scaled by the true model error to remove the effects of influencing residual variances from the prediction error so that a proper comparison is possible .</p>
<p>A dataset using <a href="experimental-design.html#eq:pred-error">(7)</a> is obtained which contains five factors for simulation parameters, prediction methods, number of components, replications and prediction error for four responses. The prediction error is computed using 0 to 10 predictor components for each 50 replicates using <a href="experimental-design.html#eq:pred-error">(7)</a>. Thus there are 32 (design) <span class="math inline">\(\times\)</span> 5 (methods) <span class="math inline">\(\times\)</span> 11 (number of components) <span class="math inline">\(\times\)</span> 50 (replications), i.e. 88000 observations. Here the variables <code>Y1</code> to <code>Y4</code> corresponds to prediction error of respective response variables.</p>
<p>Since we will focus our discussion on the minimum prediction error that a method can obtain and the number of components they use to get minimum prediciton error in each replicate, the dataset discussed above is summarized to construct following two smaller datasets. Let us call them <em>Error Dataset</em> and <em>Component Dataset</em>.</p>
<dl>
<dt><em>Error Dataset</em>:</dt>
<dd>For each prediction method, design and response, an average prediction error is computed over all replicates for each components. Next, a component that results in the minumum of this average prediction error is selected, i.e.,
<span class="math display" id="eq:min-pred">\[\begin{equation}
  nc_\circ = \operatorname*{argmin}_{nc}\left[\frac{1}{50}\sum_{i=1}^{50}{\mathcal{PE}_{ij}}\right]
  \tag{8}
  \end{equation}\]</span>
</dd>
<dd>where, <span class="math inline">\(nc\)</span> is the number of components and <span class="math inline">\(\mathcal{PE}_{ij}\)</span> is prediction error computed using <a href="experimental-design.html#eq:pred-error">(7)</a> for response <span class="math inline">\(j\)</span> and replication <span class="math inline">\(i\)</span>.
</dd>
<dd><p>Using the component <span class="math inline">\(nc_\circ\)</span>, the prediction error for all 50 replicates are used to construct the <em>Error Dataset</em>.</p>
</dd>
<dt><em>Component Dataset</em>:</dt>
<dd>Components that gives the minimum prediction error in each replication is used as <em>Component Dataset</em>, i.e.,
<span class="math display" id="eq:min-comp">\[\begin{equation}
  nc_j = \operatorname*{argmin}_{nc}\left[\mathcal{PE}_{j}\right]
  \tag{9}
  \end{equation}\]</span>
Here <span class="math inline">\(nc_i\)</span> is the number of component that gives minimum prediction error for <span class="math inline">\(j^\text{th}\)</span> response for each replication.
</dd>
</dl>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="prediction-methods.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="exploration.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": true,
"facebook": false,
"twitter": true,
"google": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/therimalaya/03-prediction-comparison/edit/master/Includes/03-ExperimentalDesign.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": ["main.epub", "main.pdf"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
